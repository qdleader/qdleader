import{_ as n,c as a,a as p,o as t}from"./app-D8HvJIFE.js";const e={};function o(l,s){return t(),a("div",null,[...s[0]||(s[0]=[p(`<h1 id="tab下拉加载会请求多次问题" tabindex="-1"><a class="header-anchor" href="#tab下拉加载会请求多次问题"><span>tab下拉加载会请求多次问题</span></a></h1><p>直接上代码</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">&lt;</span>van<span class="token operator">-</span>list  <span class="token operator">:</span>finished<span class="token operator">=</span><span class="token string">&quot;finished&quot;</span> finished<span class="token operator">-</span>text<span class="token operator">=</span><span class="token string">&quot;到底啦,只有这么多了&quot;</span> @load<span class="token operator">=</span><span class="token string">&quot;onLoadDown&quot;</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;commentList.length != 0&quot;</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;loading&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">         <span class="token operator">&lt;</span>ul <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;comment_ul&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">             <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;comment_li clearfix&quot;</span> v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(item,index) in commentList&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;index&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                 <span class="token operator">&lt;</span>img <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">&quot;item.comm_user_portrait&quot;</span> alt<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                 <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;comment_ri&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                     <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;comment_ribox clearfix&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                         <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;comment_ri_left clearfix&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                             <span class="token operator">&lt;</span>h5 @click<span class="token operator">=</span><span class="token string">&quot;readBack(item)&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>comm_username<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h5<span class="token operator">&gt;</span></span>
<span class="line">                             <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>create_time <span class="token operator">|</span> <span class="token function">formatDate</span><span class="token punctuation">(</span><span class="token string">&#39;yyyy.MM.dd hh:mm&#39;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span></span>
<span class="line">                         <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">                         <span class="token operator">&lt;</span>div <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;{&#39;comment_ri_right&#39;:true,&#39;comment_ri_rightred&#39;:item.liked_status == 1}&quot;</span> @click<span class="token operator">=</span><span class="token string">&quot;doLike(item,index)&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                             <span class="token operator">&lt;</span>i <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;iconfont yk-dianzanbeifen2&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>i<span class="token operator">&gt;</span></span>
<span class="line">                             <span class="token operator">&lt;</span>i <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;iconfont yk-yidianzan&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>i<span class="token operator">&gt;</span></span>
<span class="line">                             <span class="token operator">&lt;</span>cite<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>liked_num<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>cite<span class="token operator">&gt;</span></span>
<span class="line">                         <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">                     <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">                     <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;comment_ri_con&quot;</span> @click<span class="token operator">=</span><span class="token string">&quot;readBack(item)&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                         <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>comm_content<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">                     <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line">                     <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;comment_ri_back&quot;</span> v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">&quot;item.son_comment_count != 0&quot;</span> @click<span class="token operator">=</span><span class="token string">&quot;lookSonCom(item)&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                         <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>son_comment_count<span class="token punctuation">}</span><span class="token punctuation">}</span>次回复 <span class="token operator">&gt;</span></span>
<span class="line">                     <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">                 <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">             <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span>
<span class="line">         <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span></span>
<span class="line"> <span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>list<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 异步更新数据</span></span>
<span class="line">    <span class="token keyword">const</span> _self <span class="token operator">=</span> <span class="token keyword">this</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">let</span> uidPub <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token function">decodeURI</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>UserInfoSave<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>uid</span>
<span class="line">    <span class="token keyword">let</span> courseNum <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>courseType<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&#39;undefined&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;this.course_type11111111111&quot;</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>courseType<span class="token punctuation">)</span></span>
<span class="line">        courseNum <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>courseType</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token function">commentList</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">page</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>currentPage <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">uid</span><span class="token operator">:</span>uidPub <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">pageSize</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pageSize <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span></span>
<span class="line">         <span class="token literal-property property">course_id</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>act_id_new <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span></span>
<span class="line">         <span class="token literal-property property">file_type</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileType <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span></span>
<span class="line">         <span class="token literal-property property">course_type</span><span class="token operator">:</span>courseNum <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;评论列表&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">// this.loading = false;</span></span>
<span class="line">        <span class="token comment">// this.list = res.data.data;</span></span>
<span class="line">        <span class="token comment">// this.finished = true;</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>isLoading <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">const</span> rows <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data</span>
<span class="line">            <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                   _self<span class="token punctuation">.</span>finished <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">                <span class="token comment">// _self.commentList = []</span></span>
<span class="line">                <span class="token keyword">return</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token comment">//第一页如果没有，才显示空状态</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>rows<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>currentPage <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">// 加载结束</span></span>
<span class="line">                _self<span class="token punctuation">.</span>finished <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">                _self<span class="token punctuation">.</span>commentList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">                <span class="token keyword">return</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>rows <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> rows<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">// 加载结束</span></span>
<span class="line">                _self<span class="token punctuation">.</span>finished <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">                <span class="token comment">// _self.commentList = []</span></span>
<span class="line">                <span class="token keyword">return</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>rows<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pageSize<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">// 最后一页不足10条的情况</span></span>
<span class="line">                _self<span class="token punctuation">.</span>finished <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token comment">// 处理数据</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>_self<span class="token punctuation">.</span>currentPage <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                _self<span class="token punctuation">.</span>list <span class="token operator">=</span> rows</span>
<span class="line">            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">                _self<span class="token punctuation">.</span>list <span class="token operator">=</span> _self<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token comment">// _self.commentList = this.sort_pro(_self.list,[&#39;play_date&#39;])</span></span>
<span class="line">            _self<span class="token punctuation">.</span>commentList <span class="token operator">=</span> _self<span class="token punctuation">.</span>list</span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        _self<span class="token punctuation">.</span>finished <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">        <span class="token comment">// this.$message({</span></span>
<span class="line">        <span class="token comment">//     showClose: true,</span></span>
<span class="line">        <span class="token comment">//     message: &#39;获取资源列表异常{&#39; + error + &#39;}&#39;,</span></span>
<span class="line">        <span class="token comment">//     type: &#39;error&#39;</span></span>
<span class="line">        <span class="token comment">// })</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        _self<span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>isLoading <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line">        <span class="token comment">// _self.isUpLoading = false</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token comment">// 上拉加载请求方法</span></span>
<span class="line"><span class="token function">onLoadDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>currentPage <span class="token operator">++</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>你这么写就会发现，到页面底部时候，不再多请求数据了。</p><p>关键其实就是</p><p>在onLoadDown方法里面的在this.onLoad方法前面加，this.loading = true即可。</p>`,7)])])}const i=n(e,[["render",o]]),r=JSON.parse('{"path":"/UI%E6%A1%86%E6%9E%B6/vant/tab%E4%B8%8B%E6%8B%89%E5%8A%A0%E8%BD%BD%E4%BC%9A%E8%AF%B7%E6%B1%82%E5%A4%9A%E6%AC%A1%E9%97%AE%E9%A2%98.html","title":"tab下拉加载会请求多次问题","lang":"zh-CN","frontmatter":{},"git":{"updatedTime":1761877037000,"contributors":[{"name":"qdleader","username":"qdleader","email":"yk4545945@163.com","commits":1,"url":"https://github.com/qdleader"}],"changelog":[{"hash":"bd7640b59685e94edda53b9f6d34fbec27933dd4","time":1761877037000,"email":"yk4545945@163.com","author":"qdleader","message":"docs: 更新仓库链接和添加交流社区信息"}]},"filePathRelative":"UI框架/vant/tab下拉加载会请求多次问题.md"}');export{i as comp,r as data};
