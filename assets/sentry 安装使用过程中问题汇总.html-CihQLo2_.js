import{_ as n,c as a,a as e,o as p}from"./app-D8HvJIFE.js";const t={};function o(l,s){return p(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="记录一下sentry安装中遇到的问题" tabindex="-1"><a class="header-anchor" href="#记录一下sentry安装中遇到的问题"><span>记录一下Sentry安装中遇到的问题</span></a></h1><h2 id="_1、配置https访问-解决net-err-ssl-protocol-error-错误" tabindex="-1"><a class="header-anchor" href="#_1、配置https访问-解决net-err-ssl-protocol-error-错误"><span>1、配置HTTPS访问，解决net::ERR_SSL_PROTOCOL_ERROR 错误</span></a></h2><p>修改 Self-hosted/sentry/config.yml</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">system<span class="token punctuation">.</span>url<span class="token operator">-</span>prefix<span class="token operator">:</span> <span class="token string">&#39;https://xxx.com&#39;</span> <span class="token comment">// 实际访问地址，最后不加 /</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>YAML 修改Self-hosted/sentry/sentry.yml ，去掉下方代码的注释</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token constant">SECURE_PROXY_SSL_HEADER</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&#39;HTTP_X_FORWARDED_PROTO&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;https&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token constant">USE_X_FORWARDED_HOST</span> <span class="token operator">=</span> True</span>
<span class="line"><span class="token constant">SESSION_COOKIE_SECURE</span> <span class="token operator">=</span> True</span>
<span class="line"><span class="token constant">CSRF_COOKIE_SECURE</span> <span class="token operator">=</span> True</span>
<span class="line"><span class="token constant">SOCIAL_AUTH_REDIRECT_IS_HTTPS</span> <span class="token operator">=</span> True</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="最后重新启动compose" tabindex="-1"><a class="header-anchor" href="#最后重新启动compose"><span>最后重新启动compose</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">docker-compose</span> down</span>
<span class="line"><span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2、使用nginx反向代理sentry服务" tabindex="-1"><a class="header-anchor" href="#_2、使用nginx反向代理sentry服务"><span>2、使用nginx反向代理sentry服务</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">upstream sentry <span class="token punctuation">{</span></span>
<span class="line">    server <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">9000</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">server</span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	listen <span class="token number">443</span> ssl<span class="token punctuation">;</span></span>
<span class="line">    server_name xxx<span class="token punctuation">.</span>com<span class="token punctuation">;</span></span>
<span class="line">    index index<span class="token punctuation">.</span>php index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>htm <span class="token keyword">default</span><span class="token punctuation">.</span>php <span class="token keyword">default</span><span class="token punctuation">.</span>htm <span class="token keyword">default</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span></span>
<span class="line">    root <span class="token operator">/</span>www<span class="token operator">/</span>wwwroot<span class="token operator">/</span>xxx<span class="token punctuation">.</span>com<span class="token punctuation">;</span></span>
<span class="line">    location <span class="token operator">/</span> <span class="token punctuation">{</span></span>
<span class="line">      proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>sentry<span class="token punctuation">;</span></span>
<span class="line">      proxy_set_header Host $host<span class="token operator">:</span>$proxy_port<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    #<span class="token constant">SSL</span><span class="token operator">-</span><span class="token constant">START</span> <span class="token constant">SSL</span>相关配置，请勿删除或修改下一行带注释的<span class="token number">404</span>规则</span>
<span class="line">    #error_page <span class="token number">404</span><span class="token operator">/</span><span class="token number">404</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    ssl_certificate    <span class="token operator">/</span>path<span class="token operator">/</span>to<span class="token operator">/</span>xxx<span class="token punctuation">.</span>pem<span class="token punctuation">;</span></span>
<span class="line">    ssl_certificate_key    <span class="token operator">/</span>path<span class="token operator">/</span>to<span class="token operator">/</span>xxx<span class="token punctuation">.</span>pem<span class="token punctuation">;</span></span>
<span class="line">    ssl_protocols TLSv1<span class="token punctuation">.</span><span class="token number">1</span> TLSv1<span class="token punctuation">.</span><span class="token number">2</span> TLSv1<span class="token punctuation">.</span><span class="token number">3</span><span class="token punctuation">;</span></span>
<span class="line">    ssl_ciphers <span class="token constant">EECDH</span><span class="token operator">+</span><span class="token constant">CHACHA20</span><span class="token operator">:</span><span class="token constant">EECDH</span><span class="token operator">+</span><span class="token constant">CHACHA20</span><span class="token operator">-</span>draft<span class="token operator">:</span><span class="token constant">EECDH</span><span class="token operator">+</span><span class="token constant">AES128</span><span class="token operator">:</span><span class="token constant">RSA</span><span class="token operator">+</span><span class="token constant">AES128</span><span class="token operator">:</span><span class="token constant">EECDH</span><span class="token operator">+</span><span class="token constant">AES256</span><span class="token operator">:</span><span class="token constant">RSA</span><span class="token operator">+</span><span class="token constant">AES256</span><span class="token operator">:</span><span class="token constant">EECDH</span><span class="token operator">+</span>3DES<span class="token operator">:</span><span class="token constant">RSA</span><span class="token operator">+</span>3DES<span class="token operator">:</span><span class="token operator">!</span><span class="token constant">MD5</span><span class="token punctuation">;</span></span>
<span class="line">    ssl_prefer_server_ciphers on<span class="token punctuation">;</span></span>
<span class="line">    ssl_session_cache shared<span class="token operator">:</span><span class="token constant">SSL</span><span class="token operator">:</span>10m<span class="token punctuation">;</span></span>
<span class="line">    ssl_session_timeout 10m<span class="token punctuation">;</span></span>
<span class="line">    add_header Strict<span class="token operator">-</span>Transport<span class="token operator">-</span>Security <span class="token string">&quot;max-age=31536000&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    error_page <span class="token number">497</span>  <span class="token literal-property property">https</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>$host$request_uri<span class="token punctuation">;</span></span>
<span class="line">	</span>
<span class="line">    access_log  <span class="token operator">/</span>dev<span class="token operator">/</span><span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line">    error_log  <span class="token operator">/</span>dev<span class="token operator">/</span><span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="sentry-设置root-url地址" tabindex="-1"><a class="header-anchor" href="#sentry-设置root-url地址"><span>sentry 设置root url地址</span></a></h2><p>安装好sentry后我们查看后台会发现地址是改不了的</p><p>根据图上提示是去conifg.yml中去修改，但是我去查看配置时并没有提示或者注释过的参数配置</p><p>最后得知字段名字是 system.url-prefix</p><p>system.url-prefix: &#39;http://192.168.0.117:9001&#39; 加上配置即可</p><p>ps：地址最后是没有 ‘‘/’’的，加了就会多一个，千万记得不能多，其中的地址也可以换成域名，需要自己用niginx做反向代理即可</p><p>最后修改完成后，保存 重启</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">docker-compose</span> down</span>
<span class="line"><span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div>`,18)])])}const r=n(t,[["render",o]]),i=JSON.parse('{"path":"/%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/sentry/sentry%20%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB.html","title":"记录一下Sentry安装中遇到的问题","lang":"zh-CN","frontmatter":{},"git":{"updatedTime":1761877037000,"contributors":[{"name":"qdleader","username":"qdleader","email":"yk4545945@163.com","commits":1,"url":"https://github.com/qdleader"}],"changelog":[{"hash":"bd7640b59685e94edda53b9f6d34fbec27933dd4","time":1761877037000,"email":"yk4545945@163.com","author":"qdleader","message":"docs: 更新仓库链接和添加交流社区信息"}]},"filePathRelative":"监控告警/sentry/sentry 安装使用过程中问题汇总.md"}');export{r as comp,i as data};
