# MCP é…ç½®è¯´æ˜

## ğŸ”§ ä¸¤ç§é…ç½®æ–¹å¼

### 1ï¸âƒ£ æœ¬åœ°å¼€å‘é…ç½®ï¼ˆåŒ…æœªå‘å¸ƒåˆ° npmï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šæ­£åœ¨å¼€å‘ MCPï¼Œè¿˜æ²¡å‘å¸ƒåˆ° npm

**Cursor é…ç½®** (`~/.cursor/mcp.json`)ï¼š

```json
{
  "mcpServers": {
    "qdleader": {
      "command": "node",
      "args": ["/Users/icourt/github/qdleader/mcp-server/dist/index.js"]
    }
  }
}
```

**å…³é”®ç‚¹**ï¼š
- âœ… ä½¿ç”¨ `node` å‘½ä»¤
- âœ… æŒ‡å‘æœ¬åœ°ç¼–è¯‘åçš„ `dist/index.js` æ–‡ä»¶
- âœ… ä½¿ç”¨ç»å¯¹è·¯å¾„
- âš ï¸ æ¯æ¬¡ä¿®æ”¹ä»£ç åéœ€è¦é‡æ–° `npm run build`

### 2ï¸âƒ£ npm åŒ…é…ç½®ï¼ˆå·²å‘å¸ƒåˆ° npmï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šåŒ…å·²å‘å¸ƒåˆ° npmï¼Œå…¶ä»–ç”¨æˆ·ä½¿ç”¨

**Cursor é…ç½®**ï¼š

```json
{
  "mcpServers": {
    "qdleader": {
      "command": "npx",
      "args": ["-y", "qdleader-mcp"]
    }
  }
}
```

**å…³é”®ç‚¹**ï¼š
- âœ… ä½¿ç”¨ `npx` å‘½ä»¤
- âœ… è‡ªåŠ¨ä» npm ä¸‹è½½æœ€æ–°ç‰ˆæœ¬
- âœ… æ— éœ€æœ¬åœ°å®‰è£…
- âœ… ç”¨æˆ·å‹å¥½

## ğŸ”„ åˆ‡æ¢æµç¨‹

### ä»æœ¬åœ°å¼€å‘åˆ‡æ¢åˆ° npm åŒ…

1. **å‘å¸ƒåŒ…åˆ° npm**
   ```bash
   cd /Users/icourt/github/qdleader/mcp-server
   npm login
   npm publish --access public
   ```

2. **æ›´æ–° Cursor é…ç½®**
   
   å°†é…ç½®æ”¹ä¸ºï¼š
   ```json
   {
     "mcpServers": {
       "qdleader": {
         "command": "npx",
         "args": ["-y", "qdleader-mcp"]
       }
     }
   }
   ```

3. **é‡å¯ Cursor**

### ä» npm åŒ…åˆ‡æ¢å›æœ¬åœ°å¼€å‘

å¦‚æœéœ€è¦è°ƒè¯•æˆ–ä¿®æ”¹ä»£ç ï¼š

1. **æ›´æ–° Cursor é…ç½®**
   
   æ”¹å›æœ¬åœ°è·¯å¾„ï¼š
   ```json
   {
     "mcpServers": {
       "qdleader": {
         "command": "node",
         "args": ["/Users/icourt/github/qdleader/mcp-server/dist/index.js"]
       }
     }
   }
   ```

2. **é‡æ–°æ„å»º**
   ```bash
   cd /Users/icourt/github/qdleader/mcp-server
   npm run build
   ```

3. **é‡å¯ Cursor**

## ğŸ› å¸¸è§é—®é¢˜

### Q1: `spawn npx ENOENT` é”™è¯¯

**åŸå› **ï¼šä½¿ç”¨äº† `npx` é…ç½®ï¼Œä½†åŒ…è¿˜æ²¡å‘å¸ƒåˆ° npm

**è§£å†³**ï¼šæ”¹ç”¨æœ¬åœ°å¼€å‘é…ç½®ï¼ˆnode å‘½ä»¤ + æœ¬åœ°è·¯å¾„ï¼‰

```json
{
  "mcpServers": {
    "qdleader": {
      "command": "node",
      "args": ["/Users/icourt/github/qdleader/mcp-server/dist/index.js"]
    }
  }
}
```

### Q2: `Cannot find module` é”™è¯¯

**åŸå› **ï¼š
1. æ²¡æœ‰è¿è¡Œ `npm run build`
2. `dist/` ç›®å½•ä¸å­˜åœ¨
3. è·¯å¾„ä¸æ­£ç¡®

**è§£å†³**ï¼š
```bash
cd /Users/icourt/github/qdleader/mcp-server
npm run build  # ç¡®ä¿æ„å»ºæˆåŠŸ
ls dist/       # ç¡®è®¤ index.js å­˜åœ¨
```

### Q3: MCP æœåŠ¡å™¨ä¸å¯åŠ¨

**æ£€æŸ¥æ­¥éª¤**ï¼š

1. **éªŒè¯æ–‡ä»¶å­˜åœ¨**
   ```bash
   ls -la /Users/icourt/github/qdleader/mcp-server/dist/index.js
   ```

2. **éªŒè¯æ–‡ä»¶å¯æ‰§è¡Œ**
   ```bash
   node /Users/icourt/github/qdleader/mcp-server/dist/index.js
   ```
   åº”è¯¥çœ‹åˆ°ï¼š`[MCP] QDLeader MCP Server running on stdio`

3. **æ£€æŸ¥ Cursor æ—¥å¿—**
   - æ‰“å¼€ Cursor
   - æŸ¥çœ‹å¼€å‘è€…å·¥å…·ï¼ˆHelp > Toggle Developer Toolsï¼‰
   - æŸ¥çœ‹ Console ä¸­çš„é”™è¯¯ä¿¡æ¯

4. **é‡å¯ Cursor**
   - å®Œå…¨é€€å‡º Cursor
   - é‡æ–°æ‰“å¼€

### Q4: ä¿®æ”¹ä»£ç åæ²¡æœ‰ç”Ÿæ•ˆ

**åŸå› **ï¼šæ²¡æœ‰é‡æ–°æ„å»º

**è§£å†³**ï¼š
```bash
cd /Users/icourt/github/qdleader/mcp-server
npm run build  # é‡æ–°æ„å»º
# é‡å¯ Cursor
```

æˆ–ä½¿ç”¨ watch æ¨¡å¼ï¼š
```bash
npm run dev  # ç›‘å¬æ–‡ä»¶å˜åŒ–è‡ªåŠ¨æ„å»º
```

## ğŸ“ å¼€å‘æµç¨‹å»ºè®®

### å¼€å‘é˜¶æ®µ

```bash
# 1. ä¿®æ”¹ä»£ç 
vim src/index.ts

# 2. æ„å»º
npm run build

# 3. é‡å¯ Cursor æµ‹è¯•

# 4. é‡å¤ 1-3 ç›´åˆ°æ»¡æ„
```

### å‘å¸ƒé˜¶æ®µ

```bash
# 1. æœ€åä¸€æ¬¡æ„å»ºå’Œæµ‹è¯•
npm run build
./test-package.sh

# 2. å‘å¸ƒåˆ° npm
./publish.sh

# 3. æ›´æ–° Cursor é…ç½®ä¸º npx æ¨¡å¼

# 4. æµ‹è¯• npm åŒ…ç‰ˆæœ¬
```

## ğŸ” è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹ MCP æœåŠ¡å™¨è¾“å‡º

æœ¬åœ°å¼€å‘æ—¶ï¼Œå¯ä»¥ç›´æ¥è¿è¡ŒæŸ¥çœ‹è¾“å‡ºï¼š

```bash
cd /Users/icourt/github/qdleader/mcp-server
node dist/index.js
```

åº”è¯¥çœ‹åˆ°ï¼š
```
[MCP] QDLeader MCP Server running on stdio
```

### æµ‹è¯• MCP å·¥å…·

åˆ›å»ºæµ‹è¯•è„šæœ¬ `test-mcp.js`ï¼š

```javascript
import { spawn } from 'child_process';

const mcp = spawn('node', ['dist/index.js']);

// å‘é€æµ‹è¯•è¯·æ±‚
const request = {
  jsonrpc: "2.0",
  id: 1,
  method: "tools/list"
};

mcp.stdin.write(JSON.stringify(request) + '\n');

mcp.stdout.on('data', (data) => {
  console.log('Response:', data.toString());
});
```

## ğŸ“Œ é…ç½®æ¨¡æ¿

### å®Œæ•´çš„ Cursor é…ç½®ç¤ºä¾‹

```json
{
  "mcpServers": {
    "qdleader-local": {
      "command": "node",
      "args": ["/Users/icourt/github/qdleader/mcp-server/dist/index.js"]
    },
    "qdleader-npm": {
      "command": "npx",
      "args": ["-y", "qdleader-mcp"],
      "disabled": true
    }
  }
}
```

**è¯´æ˜**ï¼š
- å¯ä»¥åŒæ—¶é…ç½®ä¸¤ä¸ªç‰ˆæœ¬
- ä½¿ç”¨ `disabled: true` æ¥åˆ‡æ¢
- æœ¬åœ°å¼€å‘æ—¶å¯ç”¨ `qdleader-local`
- æµ‹è¯• npm åŒ…æ—¶å¯ç”¨ `qdleader-npm`

## âœ… æ£€æŸ¥æ¸…å•

**æœ¬åœ°å¼€å‘å‡†å¤‡**ï¼š
- [ ] ä»£ç å·²ç¼–å†™å®Œæˆ
- [ ] è¿è¡Œ `npm run build` æˆåŠŸ
- [ ] `dist/index.js` æ–‡ä»¶å­˜åœ¨
- [ ] Cursor é…ç½®ä½¿ç”¨æœ¬åœ°è·¯å¾„
- [ ] é‡å¯ Cursor

**å‘å¸ƒå‡†å¤‡**ï¼š
- [ ] æœ¬åœ°æµ‹è¯•å®Œå…¨é€šè¿‡
- [ ] è¿è¡Œ `./test-package.sh` å…¨éƒ¨é€šè¿‡
- [ ] ç™»å½• npm (`npm login`)
- [ ] è¿è¡Œ `./publish.sh` å‘å¸ƒ
- [ ] æ›´æ–° Cursor é…ç½®ä¸º npx æ¨¡å¼
- [ ] æµ‹è¯• npm åŒ…ç‰ˆæœ¬

---

**å½“å‰é…ç½®çŠ¶æ€**ï¼šâœ… å·²æ›´æ–°ä¸ºæœ¬åœ°å¼€å‘æ¨¡å¼

**ä¸‹ä¸€æ­¥**ï¼šé‡å¯ Cursorï¼ŒMCP æœåŠ¡å™¨åº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼

